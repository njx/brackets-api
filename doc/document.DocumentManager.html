<!DOCTYPE html>
<html lang="en">
<head>
    <title>document.DocumentManager</title>
    <link rel="stylesheet" href="../assets/css/bootstrap.css">
    <link rel="stylesheet" href="../assets/css/font-awesome.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <!--[if IE 7]>
    <link rel="stylesheet" href="../assets/css/font-awesome-ie7.css">
    <![endif]-->
    <script type="text/javascript" src="../assets/js/jquery-1.7.js"></script>
    <script type="text/javascript" src="../assets/js/bootstrap.js"></script>
    <script type="text/javascript" src="../assets/js/main.js"></script>
</head>
<body>
<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="brand" href="./index.html">Brackets API</a>
            <div class="nav-collapse collapse">
                <ul class="nav">
                    <li><a href="#dependencies">Dependencies</a></li>
                    <li><a href="#variables">Variables</a></li>
                    <li><a href="#functions">Functions</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="span12">
            <div class="page-header">
                <h1>document.DocumentManager</h1>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="span3">
            <div class="left-section">
                <ul class="nav nav-list">
                    <li class="nav-header">
                        <a href="#" id="toggle-other-modules"><i class="icon-folder-close"></i> Modules (93)</a>
                    </li>
                </ul>
                <ul id="other-module" class="nav nav-list">
                    <li><a href="brackets.html">brackets</a></li>
                    <li><a href="command.CommandManager.html">command.CommandManager</a></li>
                    <li><a href="command.Commands.html">command.Commands</a></li>
                    <li><a href="command.KeyBindingManager.html">command.KeyBindingManager</a></li>
                    <li><a href="command.Menus.html">command.Menus</a></li>
                    <li><a href="debug.DebugCommandHandlers.html">debug.DebugCommandHandlers</a></li>
                    <li><a href="document.ChangedDocumentTracker.html">document.ChangedDocumentTracker</a></li>
                    <li><a href="document.DocumentCommandHandlers.html">document.DocumentCommandHandlers</a></li>
                    <li><a href="document.DocumentManager.html">document.DocumentManager</a></li>
                    <li><a href="document.TextRange.html">document.TextRange</a></li>
                    <li><a href="editor.CodeHintList.html">editor.CodeHintList</a></li>
                    <li><a href="editor.CodeHintManager.html">editor.CodeHintManager</a></li>
                    <li><a href="editor.CSSInlineEditor.html">editor.CSSInlineEditor</a></li>
                    <li><a href="editor.Editor.html">editor.Editor</a></li>
                    <li><a href="editor.EditorCommandHandlers.html">editor.EditorCommandHandlers</a></li>
                    <li><a href="editor.EditorManager.html">editor.EditorManager</a></li>
                    <li><a href="editor.EditorUtils.html">editor.EditorUtils</a></li>
                    <li><a href="editor.InlineTextEditor.html">editor.InlineTextEditor</a></li>
                    <li><a href="editor.InlineWidget.html">editor.InlineWidget</a></li>
                    <li><a href="editor.MultiRangeInlineEditor.html">editor.MultiRangeInlineEditor</a></li>
                    <li><a href="file.FileUtils.html">file.FileUtils</a></li>
                    <li><a href="file.NativeFileError.html">file.NativeFileError</a></li>
                    <li><a href="file.NativeFileSystem.html">file.NativeFileSystem</a></li>
                    <li><a href="help.HelpCommandHandlers.html">help.HelpCommandHandlers</a></li>
                    <li><a href="language.CSSUtils.html">language.CSSUtils</a></li>
                    <li><a href="language.HTMLUtils.html">language.HTMLUtils</a></li>
                    <li><a href="language.JSLintUtils.html">language.JSLintUtils</a></li>
                    <li><a href="language.JSUtils.html">language.JSUtils</a></li>
                    <li><a href="LiveDevelopment.Agents.ConsoleAgent.html">LiveDevelopment.Agents.ConsoleAgent</a></li>
                    <li><a href="LiveDevelopment.Agents.CSSAgent.html">LiveDevelopment.Agents.CSSAgent</a></li>
                    <li><a href="LiveDevelopment.Agents.DOMAgent.html">LiveDevelopment.Agents.DOMAgent</a></li>
                    <li><a href="LiveDevelopment.Agents.DOMHelpers.html">LiveDevelopment.Agents.DOMHelpers</a></li>
                    <li><a href="LiveDevelopment.Agents.DOMNode.html">LiveDevelopment.Agents.DOMNode</a></li>
                    <li><a href="LiveDevelopment.Agents.EditAgent.html">LiveDevelopment.Agents.EditAgent</a></li>
                    <li><a href="LiveDevelopment.Agents.GotoAgent.html">LiveDevelopment.Agents.GotoAgent</a></li>
                    <li><a href="LiveDevelopment.Agents.HighlightAgent.html">LiveDevelopment.Agents.HighlightAgent</a></li>
                    <li><a href="LiveDevelopment.Agents.NetworkAgent.html">LiveDevelopment.Agents.NetworkAgent</a></li>
                    <li><a href="LiveDevelopment.Agents.RemoteAgent.html">LiveDevelopment.Agents.RemoteAgent</a></li>
                    <li><a href="LiveDevelopment.Agents.RemoteFunctions.html">LiveDevelopment.Agents.RemoteFunctions</a></li>
                    <li><a href="LiveDevelopment.Agents.ScriptAgent.html">LiveDevelopment.Agents.ScriptAgent</a></li>
                    <li><a href="LiveDevelopment.Documents.CSSDocument.html">LiveDevelopment.Documents.CSSDocument</a></li>
                    <li><a href="LiveDevelopment.Documents.HTMLDocument.html">LiveDevelopment.Documents.HTMLDocument</a></li>
                    <li><a href="LiveDevelopment.Documents.JSDocument.html">LiveDevelopment.Documents.JSDocument</a></li>
                    <li><a href="LiveDevelopment.Inspector.Inspector.html">LiveDevelopment.Inspector.Inspector</a></li>
                    <li><a href="LiveDevelopment.LiveDevelopment.html">LiveDevelopment.LiveDevelopment</a></li>
                    <li><a href="LiveDevelopment.main.html">LiveDevelopment.main</a></li>
                    <li><a href="preferences.PreferencesDialogs.html">preferences.PreferencesDialogs</a></li>
                    <li><a href="preferences.PreferencesManager.html">preferences.PreferencesManager</a></li>
                    <li><a href="preferences.PreferenceStorage.html">preferences.PreferenceStorage</a></li>
                    <li><a href="project.FileIndexManager.html">project.FileIndexManager</a></li>
                    <li><a href="project.FileSyncManager.html">project.FileSyncManager</a></li>
                    <li><a href="project.FileViewController.html">project.FileViewController</a></li>
                    <li><a href="project.ProjectManager.html">project.ProjectManager</a></li>
                    <li><a href="project.SidebarView.html">project.SidebarView</a></li>
                    <li><a href="project.WorkingSetSort.html">project.WorkingSetSort</a></li>
                    <li><a href="project.WorkingSetView.html">project.WorkingSetView</a></li>
                    <li><a href="search.FindInFiles.html">search.FindInFiles</a></li>
                    <li><a href="search.FindReplace.html">search.FindReplace</a></li>
                    <li><a href="search.QuickOpen.html">search.QuickOpen</a></li>
                    <li><a href="strings.html">strings</a></li>
                    <li><a href="test.html">test</a></li>
                    <li><a href="test2.html">test2</a></li>
                    <li><a href="test3.html">test3</a></li>
                    <li><a href="utils.AppInit.html">utils.AppInit</a></li>
                    <li><a href="utils.Async.html">utils.Async</a></li>
                    <li><a href="utils.BuildInfoUtils.html">utils.BuildInfoUtils</a></li>
                    <li><a href="utils.CollectionUtils.html">utils.CollectionUtils</a></li>
                    <li><a href="utils.ExtensionLoader.html">utils.ExtensionLoader</a></li>
                    <li><a href="utils.ExtensionUtils.html">utils.ExtensionUtils</a></li>
                    <li><a href="utils.Global.html">utils.Global</a></li>
                    <li><a href="utils.KeyEvent.html">utils.KeyEvent</a></li>
                    <li><a href="utils.NativeApp.html">utils.NativeApp</a></li>
                    <li><a href="utils.PerfUtils.html">utils.PerfUtils</a></li>
                    <li><a href="utils.Resizer.html">utils.Resizer</a></li>
                    <li><a href="utils.ShellAPI.html">utils.ShellAPI</a></li>
                    <li><a href="utils.StringUtils.html">utils.StringUtils</a></li>
                    <li><a href="utils.TokenUtils.html">utils.TokenUtils</a></li>
                    <li><a href="utils.UpdateNotification.html">utils.UpdateNotification</a></li>
                    <li><a href="utils.UrlParams.html">utils.UrlParams</a></li>
                    <li><a href="utils.ViewUtils.html">utils.ViewUtils</a></li>
                    <li><a href="view.ViewCommandHandlers.html">view.ViewCommandHandlers</a></li>
                    <li><a href="widgets.bootstrap-alerts.html">widgets.bootstrap-alerts</a></li>
                    <li><a href="widgets.bootstrap-buttons.html">widgets.bootstrap-buttons</a></li>
                    <li><a href="widgets.bootstrap-dropdown.html">widgets.bootstrap-dropdown</a></li>
                    <li><a href="widgets.bootstrap-modal.html">widgets.bootstrap-modal</a></li>
                    <li><a href="widgets.bootstrap-popover.html">widgets.bootstrap-popover</a></li>
                    <li><a href="widgets.bootstrap-scrollspy.html">widgets.bootstrap-scrollspy</a></li>
                    <li><a href="widgets.bootstrap-tabs.html">widgets.bootstrap-tabs</a></li>
                    <li><a href="widgets.bootstrap-twipsy.html">widgets.bootstrap-twipsy</a></li>
                    <li><a href="widgets.Dialogs.html">widgets.Dialogs</a></li>
                    <li><a href="widgets.ModalBar.html">widgets.ModalBar</a></li>
                    <li><a href="widgets.PopUpManager.html">widgets.PopUpManager</a></li>
                    <li><a href="widgets.StatusBar.html">widgets.StatusBar</a></li>
                </ul>
            </div>
        </div>
        <div class="span9">
            <section>
                <div id="description">
                    <p>DocumentManager maintains a list of currently 'open' Documents. It also owns the list of files in<br />the working set, and the notion of which Document is currently shown in the main editor UI area.</p>

<p>Document is the model for a file's contents; it dispatches events whenever those contents change.<br />To transiently inspect a file's content, simply get a Document and call getText() on it. However,<br />to be notified of Document changes or to modify a Document, you MUST call addRef() to ensure the<br />Document instance 'stays alive' and is shared by all other who read/modify that file. ('Open'<br />Documents are all Documents that are 'kept alive', i.e. have ref count > 0).</p>

<p>To get a Document, call getDocumentForPath(); never new up a Document yourself.</p>

<p>Secretly, a Document may use an Editor instance to act as the model for its internal state. (This<br />is unavoidable because CodeMirror does not separate its model from its UI). Documents are not<br />modifiable until they have a backing 'master Editor'. Creation of the backing Editor is owned by<br />EditorManager. A Document only gets a backing Editor if it becomes the currentDocument, or if edits<br />occur in any Editor (inline or full-sized) bound to the Document; there is currently no other way<br />to ensure a Document is modifiable.</p>

<p>A non-modifiable Document may still dispatch change notifications, if the Document was changed<br />externally on disk.</p>

<p>Aside from the text content, Document tracks a few pieces of metadata - notably, whether there are<br />any unsaved changes.</p>

<p>This module dispatches several events:</p>

<ul>
<li>dirtyFlagChange -- When any Document's isDirty flag changes. The 2nd arg to the listener is the
 Document whose flag changed.</li>
<li><p>documentSaved -- When a Document's changes have been saved. The 2nd arg to the listener is the <br /> Document that has been saved.</p></li>
<li><p>currentDocumentChange -- When the value of getCurrentDocument() changes.</p>

<p>To listen for working set changes, you must listen to <em>all</em> of these events:</p></li>
<li>workingSetAdd -- When a file is added to the working set (see getWorkingSet()). The 2nd arg
 to the listener is the added FileEntry.</li>
<li>workingSetAddList -- When multiple files are added to the working set (e.g. project open, multiple file open).
 The 2nd arg to the listener is the array of added FileEntry objects.</li>
<li>workingSetRemove -- When a file is removed from the working set (see getWorkingSet()). The
 2nd arg to the listener is the removed FileEntry.</li>
<li>workingSetRemoveList -- When multiple files are removed from the working set (e.g. project close).
 The 2nd arg to the listener is the array of removed FileEntry objects.</li>
<li>workingSetReorder -- When the indexes of 2 files are swapped. Listener receives no arguments.</li>
<li><p>workingSetSort -- When the workingSet array is sorted. Listener receives no arguments.<br /> TODO (#2076): combine workingSetSort &amp; workingSetReorder since they convey nearly identical information.</p></li>
<li><p>fileNameChange -- When the name of a file or folder has changed. The 2nd arg is the old name.<br /> The 3rd arg is the new name.</p></li>
</ul>

<p>These are jQuery events, so to listen for them you do something like this:<br />   $(DocumentManager).on("eventname", handler);</p>
                </div>
            </section>

            <section id="dependencies">
                <h3>Dependencies</h3>
                <ul class="nav nav-list">
                    <li><a href="command.CommandManager.html">command.CommandManager</a></li>
                    <li><a href="command.Commands.html">command.Commands</a></li>
                    <li><a href="editor.EditorManager.html">editor.EditorManager</a></li>
                    <li><a href="file.FileUtils.html">file.FileUtils</a></li>
                    <li><a href="file.NativeFileSystem.html">file.NativeFileSystem</a></li>
                    <li><a href="preferences.PreferencesManager.html">preferences.PreferencesManager</a></li>
                    <li><a href="project.ProjectManager.html">project.ProjectManager</a></li>
                    <li><a href="utils.Async.html">utils.Async</a></li>
                    <li><a href="utils.CollectionUtils.html">utils.CollectionUtils</a></li>
                    <li><a href="utils.PerfUtils.html">utils.PerfUtils</a></li>
                </ul>
            </section>

            <section id="variables">
                <h3>Variables <label class="checkbox">
                    <input class="toggle-public" type="checkbox"> Show Private Members
                </label></h3>
                <div class="member">

                    <span class="pull-right scope">
                        
                        
                    </span>
                    <h4>PREFERENCES_CLIENT_ID</h4>
                    <dl>
                    </dl>
                    <p>Unique PreferencesManager clientID</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>var PREFERENCES_CLIENT_ID = &quot;com.adobe.brackets.DocumentManager&quot;;</code></pre>
                </div>
                <div class="member private">

                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_currentDocument</h4>
                    <dl>
                            <dt>See</dt>
                                <dd><a href='#'>DocumentManager.getCurrentDocument()</a></dd>
                            <dt>Private</dt>
                    </dl>
                    <p></p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>var _currentDocument = null;</code></pre>
                </div>
                <div class="member private">

                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_documentNavPending</h4>
                    <dl>
                            <dt>Type</dt>
                                <dd>boolean</dd>
                            <dt>Private</dt>
                    </dl>
                    <p>While true, the MRU order is frozen</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>var _documentNavPending = false;</code></pre>
                </div>
                <div class="member private">

                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_isProjectChanging</h4>
                    <dl>
                            <dt>Type</dt>
                                <dd>boolean</dd>
                            <dt>Private</dt>
                    </dl>
                    <p>While true, allow preferences to be saved</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>var _isProjectChanging = false;</code></pre>
                </div>
                <div class="member private">

                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_openDocuments</h4>
                    <dl>
                            <dt>Type</dt>
                                <dd>Object.<string, </dd>
                            <dt>Private</dt>
                    </dl>
                    <p>All documents with refCount > 0. Maps Document.file.fullPath -> Document.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>var _openDocuments = {};</code></pre>
                </div>
                <div class="member private">

                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_prefs</h4>
                    <dl>
                            <dt>Type</dt>
                                <dd>PreferenceStorage</dd>
                            <dt>Private</dt>
                    </dl>
                    <p></p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>var _prefs = {};</code></pre>
                </div>
                <div class="member private">

                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_workingSet</h4>
                    <dl>
                            <dt>Type</dt>
                                <dd>Array.<FileEntry></dd>
                            <dt>See</dt>
                                <dd><a href='#'>DocumentManager.getWorkingSet()</a></dd>
                            <dt>Private</dt>
                    </dl>
                    <p></p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>var _workingSet = [];</code></pre>
                </div>
                <div class="member private">

                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_workingSetAddedOrder</h4>
                    <dl>
                            <dt>Type</dt>
                                <dd>Array.<FileEntry></dd>
                            <dt>Private</dt>
                    </dl>
                    <p>Contains the same set of items as _workingSet, but ordered in the way they where added to _workingSet (0 = last added).</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>var _workingSetAddedOrder = [];</code></pre>
                </div>
                <div class="member private">

                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_workingSetMRUOrder</h4>
                    <dl>
                            <dt>Type</dt>
                                <dd>Array.<FileEntry></dd>
                            <dt>Private</dt>
                    </dl>
                    <p>Contains the same set of items as _workingSet, but ordered by how recently they were _currentDocument (0 = most recent).</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>var _workingSetMRUOrder = [];</code></pre>
                </div>
                <!--</ul>-->
            </section>

            <section id="functions">
                <h3>Functions <label class="checkbox">
                    <input class="toggle-public" type="checkbox"> Show Private Members
                </label></h3>
                <div class="member private">
                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_beforeProjectClose</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                    </dl>
                    <p>Handle beforeProjectClose event</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function _beforeProjectClose() {
        _savePreferences();

        &#x2F;&#x2F; When app is shutdown via shortcut key, the command goes directly to the
        &#x2F;&#x2F; app shell, so we can&#39;t reliably fire the beforeProjectClose event on
        &#x2F;&#x2F; app shutdown. To compensate, we listen for currentDocumentChange,
        &#x2F;&#x2F; workingSetAdd, and workingSetRemove events so that the prefs for
        &#x2F;&#x2F; last project used get updated. But when switching projects, after
        &#x2F;&#x2F; the beforeProjectChange event gets fired, DocumentManager.closeAll()
        &#x2F;&#x2F; causes workingSetRemove event to get fired and update the prefs to an empty
        &#x2F;&#x2F; list. So, temporarily (until projectOpen event) disallow saving prefs.
        _isProjectChanging = true;
    }</code></pre>
                </div>
                <div class="member private">
                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_clearCurrentDocument</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                    </dl>
                    <p>Changes currentDocument to null, causing no full Editor to be shown in the UI</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function _clearCurrentDocument() {
        &#x2F;&#x2F; If editor already blank, do nothing
        if (!_currentDocument) {
            return;
        }
        
        &#x2F;&#x2F; Change model &amp; dispatch event
        _currentDocument = null;
        $(exports).triggerHandler(&quot;currentDocumentChange&quot;);
        &#x2F;&#x2F; (this event triggers EditorManager to actually clear the editor UI)
    }</code></pre>
                </div>
                <div class="member private">
                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_gcDocuments</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                    </dl>
                    <p>Cleans up any loose Documents whose only ref is its own master Editor, and that Editor is not<br />rooted in the UI anywhere. This can happen if the Editor is auto-created via Document APIs that<br />trigger _ensureMasterEditor() without making it dirty. E.g. a command invoked on the focused<br />inline editor makes no-op edits or does a read-only operation.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function _gcDocuments() {
        getAllOpenDocuments().forEach(function (doc) {
            &#x2F;&#x2F; Is the only ref to this document its own master Editor?
            if (doc._refCount === 1 &amp;&amp; doc._masterEditor) {
                &#x2F;&#x2F; Destroy the Editor if it&#39;s not being kept alive by the UI
                EditorManager._destroyEditorIfUnneeded(doc);
            }
        });
    }</code></pre>
                </div>
                <div class="member private">
                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_markMostRecent</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt></dt>
                            <dd>(<em>!Document</em>) - </dd>
                    </dl>
                    <p>Moves document to the front of the MRU list, IF it's in the working set; no-op otherwise.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function _markMostRecent(doc) {
        var mruI = findInWorkingSet(doc.file.fullPath, _workingSetMRUOrder);
        if (mruI !== -1) {
            _workingSetMRUOrder.splice(mruI, 1);
            _workingSetMRUOrder.unshift(doc.file);
        }
    }</code></pre>
                </div>
                <div class="member private">
                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_projectOpen</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                    </dl>
                    <p>Initializes the working set.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function _projectOpen(e) {
        _isProjectChanging = false;
        
        &#x2F;&#x2F; file root is appended for each project
        var projectRoot = ProjectManager.getProjectRoot(),
            files = _prefs.getValue(&quot;files_&quot; + projectRoot.fullPath);

        if (!files) {
            return;
        }

        var filesToOpen = [],
            activeFile;

        &#x2F;&#x2F; Add all files to the working set without verifying that
        &#x2F;&#x2F; they still exist on disk (for faster project switching)
        files.forEach(function (value, index) {
            filesToOpen.push(new NativeFileSystem.FileEntry(value.file));
            if (value.active) {
                activeFile = value.file;
            }
        });
        addListToWorkingSet(filesToOpen);

        &#x2F;&#x2F; Initialize the active editor
        if (!activeFile &amp;&amp; _workingSet.length &gt; 0) {
            activeFile = _workingSet[0].fullPath;
        }

        if (activeFile) {
            var promise = CommandManager.execute(Commands.FILE_OPEN, { fullPath: activeFile });
            &#x2F;&#x2F; Add this promise to the event&#39;s promises to signal that this handler isn&#39;t done yet
            e.promises.push(promise);
        }
    }</code></pre>
                </div>
                <div class="member private">
                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_removeAllFromWorkingSet</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                    </dl>
                    <p>Removes all files from the working set list.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function _removeAllFromWorkingSet() {
        var fileList = _workingSet;

        &#x2F;&#x2F; Remove all
        _workingSet = [];
        _workingSetMRUOrder = [];
        _workingSetAddedOrder = [];

        &#x2F;&#x2F; Dispatch event
        $(exports).triggerHandler(&quot;workingSetRemoveList&quot;, [fileList]);
    }</code></pre>
                </div>
                <div class="member private">
                    <span class="pull-right scope">
                        Private
                        
                    </span>
                    <h4>_savePreferences</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                    </dl>
                    <p>Preferences callback. Saves the document file paths for the working set.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function _savePreferences() {

        if (_isProjectChanging) {
            return;
        }
        
        &#x2F;&#x2F; save the working set file paths
        var files       = [],
            isActive    = false,
            workingSet  = getWorkingSet(),
            currentDoc  = getCurrentDocument(),
            projectRoot = ProjectManager.getProjectRoot();

        if (!projectRoot) {
            return;
        }

        workingSet.forEach(function (file, index) {
            &#x2F;&#x2F; flag the currently active editor
            isActive = currentDoc &amp;&amp; (file.fullPath === currentDoc.file.fullPath);

            files.push({
                file: file.fullPath,
                active: isActive
            });
        });

        &#x2F;&#x2F; append file root to make file list unique for each project
        _prefs.setValue(&quot;files_&quot; + projectRoot.fullPath, files);
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>addListToWorkingSet</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>fileList</dt>
                            <dd>(<em>!FileEntryArray</em>) - </dd>
                    </dl>
                    <p>Adds the given file list to the end of the working set list.<br />Does not change which document is currently open in the editor.<br />More efficient than calling addToWorkingSet() (in a loop) for<br />a list of files because there's only 1 redraw at the end</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function addListToWorkingSet(fileList) {
        var uniqueFileList = [];

        &#x2F;&#x2F; Process only files not already in working set
        fileList.forEach(function (file, index) {
            &#x2F;&#x2F; If doc is already in working set, don&#39;t add it again
            if (findInWorkingSet(file.fullPath) === -1) {
                uniqueFileList.push(file);

                &#x2F;&#x2F; Add
                _workingSet.push(file);

                &#x2F;&#x2F; Add to MRU order: either first or last, depending on whether it&#39;s already the current doc or not
                if (_currentDocument &amp;&amp; _currentDocument.file.fullPath === file.fullPath) {
                    _workingSetMRUOrder.unshift(file);
                } else {
                    _workingSetMRUOrder.push(file);
                }
                
                &#x2F;&#x2F; Add first to Added order
                _workingSetAddedOrder.splice(index, 1, file);
            }
        });
        

        &#x2F;&#x2F; Dispatch event
        $(exports).triggerHandler(&quot;workingSetAddList&quot;, [uniqueFileList]);
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>addToWorkingSet</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>file</dt>
                            <dd>(<em>!FileEntry</em>) - </dd>
                    </dl>
                    <p>Adds the given file to the end of the working set list, if it is not already in the list.<br />Does not change which document is currently open in the editor. Completes synchronously.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function addToWorkingSet(file) {
        &#x2F;&#x2F; If doc is already in working set, don&#39;t add it again
        if (findInWorkingSet(file.fullPath) !== -1) {
            return;
        }
        
        &#x2F;&#x2F; Add to _workingSet making sure we store a different instance from the
        &#x2F;&#x2F; one in the Document. See issue #1971 for more details.        
        file = new NativeFileSystem.FileEntry(file.fullPath);
        _workingSet.push(file);
        
        &#x2F;&#x2F; Add to MRU order: either first or last, depending on whether it&#39;s already the current doc or not
        if (_currentDocument &amp;&amp; _currentDocument.file.fullPath === file.fullPath) {
            _workingSetMRUOrder.unshift(file);
        } else {
            _workingSetMRUOrder.push(file);
        }
        
        &#x2F;&#x2F; Add first to Added order
        _workingSetAddedOrder.unshift(file);
        
        &#x2F;&#x2F; Dispatch event
        $(exports).triggerHandler(&quot;workingSetAdd&quot;, file);
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>beginDocumentNavigation</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                    </dl>
                    <p>Indicate that changes to currentDocument are temporary for now, and should not update the MRU<br />ordering of the working set. Useful for next/previous keyboard navigation (until Ctrl is released)<br />or for incremental-search style document preview like Quick Open will eventually have.<br />Can be called any number of times, and ended by a single finalizeDocumentNavigation() call.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function beginDocumentNavigation() {
        _documentNavPending = true;
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>closeAll</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                    </dl>
                    <p>Equivalent to calling closeFullEditor() for all Documents. Same caveat: this discards any<br />unsaved changes, so the UI should confirm with the user before calling this.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function closeAll() {
        _clearCurrentDocument();
        _removeAllFromWorkingSet();
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>closeFullEditor</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>file</dt>
                            <dd>(<em>!FileEntry</em>) - </dd>
                    </dl>
                    <p>Closes the full editor for the given file (if there is one), and removes it from the working<br />set. Any other editors for this Document remain open. Discards any unsaved changes - it is<br />expected that the UI has already confirmed with the user before calling this.</p>

<p>Changes currentDocument if this file was the current document (may change to null).</p>

<p>This is a subset of notifyFileDeleted(). Use this for the user-facing Close command.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function closeFullEditor(file) {
        &#x2F;&#x2F; If this was the current document shown in the editor UI, we&#39;re going to switch to a
        &#x2F;&#x2F; different document (or none if working set has no other options)
        if (_currentDocument &amp;&amp; _currentDocument.file.fullPath === file.fullPath) {
            &#x2F;&#x2F; Get next most recent doc in the MRU order
            var nextFile = getNextPrevFile(1);
            if (nextFile &amp;&amp; nextFile.fullPath === _currentDocument.file.fullPath) {
                &#x2F;&#x2F; getNextPrevFile() might return the file we&#39;re about to close if it&#39;s the only one open (due to wraparound)
                nextFile = null;
            }
            
            &#x2F;&#x2F; Switch editor to next document (or blank it out)
            if (nextFile) {
                CommandManager.execute(Commands.FILE_OPEN, { fullPath: nextFile.fullPath })
                    .done(function () {
                        &#x2F;&#x2F; (Now we&#39;re guaranteed that the current document is not the one we&#39;re closing)
                        console.assert(!(_currentDocument &amp;&amp; _currentDocument.file.fullPath === file.fullPath));
                    })
                    .fail(function () {
                        &#x2F;&#x2F; File chosen to be switched to could not be opened, and the original file
                        &#x2F;&#x2F; is still in editor. Close it again so code will try to open the next file,
                        &#x2F;&#x2F; or empty the editor if there are no other files. 
                        closeFullEditor(file);
                    });
            } else {
                _clearCurrentDocument();
            }
        }
        
        &#x2F;&#x2F; Remove closed doc from working set, if it was in there
        &#x2F;&#x2F; This happens regardless of whether the document being closed was the current one or not
        removeFromWorkingSet(file);
        
        &#x2F;&#x2F; Note: EditorManager will dispose the closed document&#39;s now-unneeded editor either in
        &#x2F;&#x2F; response to the editor-swap call above, or the removeFromWorkingSet() call, depending on
        &#x2F;&#x2F; circumstances. See notes in EditorManager for more.
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>finalizeDocumentNavigation</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                    </dl>
                    <p>Un-freezes the MRU list after one or more beginDocumentNavigation() calls. Whatever document is<br />current is bumped to the front of the MRU list.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function finalizeDocumentNavigation() {
        if (_documentNavPending) {
            _documentNavPending = false;
            
            _markMostRecent(_currentDocument);
        }
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>findInWorkingSet</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>fullPath</dt>
                            <dd>(<em>!string</em>) - </dd>
                            <dt>list</dt>
                            <dd>(<em>Array.&lt;FileEntry&gt;=</em>) - Pass this arg to search a different array of files. Internal</dd>
                    </dl>
                    <p>Returns the index of the file matching fullPath in the working set.<br />Returns -1 if not found.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function findInWorkingSet(fullPath, list) {
        list = list || _workingSet;
        
        return CollectionUtils.indexOf(list, function (file, i) {
            return file.fullPath === fullPath;
        });
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>findInWorkingSetAddedOrder</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>fullPath</dt>
                            <dd>(<em>!string</em>) - </dd>
                    </dl>
                    <p>Returns the index of the file matching fullPath in _workingSetAddedOrder.<br />Returns -1 if not found.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function findInWorkingSetAddedOrder(fullPath) {
        return findInWorkingSet(fullPath, _workingSetAddedOrder);
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>getAllOpenDocuments</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>Returns</dt>
                            <dd>(<em>Array.&lt;Document&gt;</em>) - </dd>
                    </dl>
                    <p>Returns all Documents that are 'open' in the UI somewhere (for now, this means open in an<br />inline editor and/or a full-size editor). Only these Documents can be modified, and only<br />these Documents are synced with external changes on disk.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function getAllOpenDocuments() {
        var result = [];
        var path;
        for (path in _openDocuments) {
            if (_openDocuments.hasOwnProperty(path)) {
                result.push(_openDocuments[path]);
            }
        }
        return result;
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>getCurrentDocument</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>Returns</dt>
                            <dd>(<em>?Document</em>) - </dd>
                    </dl>
                    <p>Returns the Document that is currently open in the editor UI. May be null.<br />When this changes, DocumentManager dispatches a "currentDocumentChange" event. The current<br />document always has a backing Editor (Document._masterEditor != null) and is thus modifiable.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function getCurrentDocument() {
        return _currentDocument;
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>getDocumentForPath</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>fullPath</dt>
                            <dd>(<em>!string</em>) - </dd>
                            <dt>Returns</dt>
                            <dd>(<em>$.Promise</em>) - A promise object that will be resolved with the Document, or rejected</dd>
                    </dl>
                    <p>Gets an existing open Document for the given file, or creates a new one if the Document is<br />not currently open ('open' means referenced by the UI somewhere). Always use this method to<br />get Documents; do not call the Document constructor directly. This method is safe to call<br />in parallel.</p>

<p>If you are going to hang onto the Document for more than just the duration of a command - e.g.<br />if you are going to display its contents in a piece of UI - then you must addRef() the Document<br />and listen for changes on it. (Note: opening the Document in an Editor automatically manages<br />refs and listeners for that Editor UI).</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function getDocumentForPath(fullPath) {
        var doc             = _openDocuments[fullPath],
            pendingPromise  = getDocumentForPath._pendingDocumentPromises[fullPath];

        if (doc) {
            &#x2F;&#x2F; use existing document
            return new $.Deferred().resolve(doc).promise();
        } else if (pendingPromise) {
            &#x2F;&#x2F; wait for the result of a previous request
            return pendingPromise;
        } else {
            var result = new $.Deferred(),
                promise = result.promise();
            
            &#x2F;&#x2F; log this document&#39;s Promise as pending
            getDocumentForPath._pendingDocumentPromises[fullPath] = promise;

            &#x2F;&#x2F; create a new document
            var fileEntry = new NativeFileSystem.FileEntry(fullPath),
                perfTimerName = PerfUtils.markStart(&quot;getDocumentForPath:\t&quot; + fullPath);

            result.done(function () {
                PerfUtils.addMeasurement(perfTimerName);
            }).fail(function () {
                PerfUtils.finalizeMeasurement(perfTimerName);
            });

            FileUtils.readAsText(fileEntry)
                .always(function () {
                    &#x2F;&#x2F; document is no longer pending
                    delete getDocumentForPath._pendingDocumentPromises[fullPath];
                })
                .done(function (rawText, readTimestamp) {
                    doc = new Document(fileEntry, readTimestamp, rawText);
                    result.resolve(doc);
                })
                .fail(function (fileError) {
                    result.reject(fileError);
                });
            
            return promise;
        }
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>getNextPrevFile</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>inc</dt>
                            <dd>(<em>Number</em>) - -1 for previous, +1 for next; no other values allowed</dd>
                            <dt>Returns</dt>
                            <dd>(<em>?FileEntry</em>) - null if working set empty</dd>
                    </dl>
                    <p>Get the next or previous file in the working set, in MRU order (relative to currentDocument). May<br />return currentDocument itself if working set is length 1.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function getNextPrevFile(inc) {
        if (inc !== -1 &amp;&amp; inc !== +1) {
            console.error(&quot;Illegal argument: inc = &quot; + inc);
            return null;
        }
        
        if (_currentDocument) {
            var mruI = findInWorkingSet(_currentDocument.file.fullPath, _workingSetMRUOrder);
            if (mruI === -1) {
                &#x2F;&#x2F; If doc not in working set, return most recent working set item
                if (_workingSetMRUOrder.length &gt; 0) {
                    return _workingSetMRUOrder[0];
                }
            } else {
                &#x2F;&#x2F; If doc is in working set, return next&#x2F;prev item with wrap-around
                var newI = mruI + inc;
                if (newI &gt;= _workingSetMRUOrder.length) {
                    newI = 0;
                } else if (newI &lt; 0) {
                    newI = _workingSetMRUOrder.length - 1;
                }
                
                return _workingSetMRUOrder[newI];
            }
        }
        
        &#x2F;&#x2F; If no doc open or working set empty, there is no &quot;next&quot; file
        return null;
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>getOpenDocumentForPath</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>fullPath</dt>
                            <dd>(<em>!string</em>) - </dd>
                            <dt>Returns</dt>
                            <dd>(<em>?Document</em>) - </dd>
                    </dl>
                    <p>Returns the existing open Document for the given file, or null if the file is not open ('open'<br />means referenced by the UI somewhere). If you will hang onto the Document, you must addRef()<br />it; see {@link getDocumentForPath()} for details.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function getOpenDocumentForPath(fullPath) {
        return _openDocuments[fullPath];
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>getWorkingSet</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>Returns</dt>
                            <dd>(<em>Array.&lt;FileEntry&gt;</em>) - </dd>
                    </dl>
                    <p>Returns a list of items in the working set in UI list order. May be 0-length, but never null.</p>

<p>When a file is added this list, DocumentManager dispatches a "workingSetAdd" event.<br />When a file is removed from list, DocumentManager dispatches a "workingSetRemove" event.<br />To listen for ALL changes to this list, you must listen for both events.</p>

<p>Which items belong in the working set is managed entirely by DocumentManager. Callers cannot<br />(yet) change this collection on their own.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function getWorkingSet() {
        return _workingSet;
        &#x2F;&#x2F; TODO: (issue #297) return a clone to prevent meddling?
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>notifyFileDeleted</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>file</dt>
                            <dd>(<em>!FileEntry</em>) - </dd>
                    </dl>
                    <p>Reacts to a file being deleted: if there is a Document for this file, causes it to dispatch a<br />"deleted" event; ensures it's not the currentDocument; and removes this file from the working<br />set. These actions in turn cause all open editors for this file to close. Discards any unsaved<br />changes - it is expected that the UI has already confirmed with the user before calling.</p>

<p>To simply close a main editor when the file hasn't been deleted, use closeFullEditor() or FILE_CLOSE.</p>

<p>FUTURE: Instead of an explicit notify, we should eventually listen for deletion events on some<br />sort of "project file model," making this just a private event handler.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function notifyFileDeleted(file) {
        &#x2F;&#x2F; First ensure it&#39;s not currentDocument, and remove from working set
        closeFullEditor(file);
        
        &#x2F;&#x2F; Notify all other editors to close as well
        var doc = getOpenDocumentForPath(file.fullPath);
        if (doc) {
            $(doc).triggerHandler(&quot;deleted&quot;);
        }
        
        &#x2F;&#x2F; At this point, all those other views SHOULD have released the Doc
        if (doc &amp;&amp; doc._refCount &gt; 0) {
            console.log(&quot;WARNING: deleted Document still has &quot; + doc._refCount + &quot; references. Did someone addRef() without listening for &#39;deleted&#39;?&quot;);
        }
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>notifyPathNameChanged</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>oldName</dt>
                            <dd>(<em>string</em>) - The old name of the file/folder</dd>
                            <dt>newName</dt>
                            <dd>(<em>string</em>) - The new name of the file/folder</dd>
                            <dt>isFolder</dt>
                            <dd>(<em>boolean</em>) - True if path is a folder; False if it is a file.</dd>
                    </dl>
                    <p>Called after a file or folder name has changed. This function is responsible<br />for updating underlying model data and notifying all views of the change.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function notifyPathNameChanged(oldName, newName, isFolder) {
        var i, path;
        
        &#x2F;&#x2F; Update open documents. This will update _currentDocument too, since 
        &#x2F;&#x2F; the current document is always open.
        var keysToDelete = [];
        for (path in _openDocuments) {
            if (_openDocuments.hasOwnProperty(path)) {
                if (path.indexOf(oldName) === 0) {
                    &#x2F;&#x2F; Copy value to new key
                    var newKey = path.replace(oldName, newName);
                    
                    _openDocuments[newKey] = _openDocuments[path];
                    keysToDelete.push(path);
                    
                    &#x2F;&#x2F; Update document file
                    FileUtils.updateFileEntryPath(_openDocuments[newKey].file, oldName, newName);
                        
                    if (!isFolder) {
                        &#x2F;&#x2F; If the path name is a file, there can only be one matched entry in the open document
                        &#x2F;&#x2F; list, which we just updated. Break out of the for .. in loop. 
                        break;
                    }
                }
            }
        }
        &#x2F;&#x2F; Delete the old keys
        for (i = 0; i &lt; keysToDelete.length; i++) {
            delete _openDocuments[keysToDelete[i]];
        }
        
        &#x2F;&#x2F; Update working set
        for (i = 0; i &lt; _workingSet.length; i++) {
            FileUtils.updateFileEntryPath(_workingSet[i], oldName, newName);
        }
        
        &#x2F;&#x2F; Send a &quot;fileNameChanged&quot; event. This will trigger the views to update.
        $(exports).triggerHandler(&quot;fileNameChange&quot;, [oldName, newName]);
    }
    
    &#x2F;&#x2F; Define public API
    exports.Document                    = Document;
    exports.getCurrentDocument          = getCurrentDocument;
    exports.getDocumentForPath          = getDocumentForPath;
    exports.getOpenDocumentForPath      = getOpenDocumentForPath;
    exports.getWorkingSet               = getWorkingSet;
    exports.findInWorkingSet            = findInWorkingSet;
    exports.findInWorkingSetAddedOrder  = findInWorkingSetAddedOrder;
    exports.getAllOpenDocuments         = getAllOpenDocuments;
    exports.setCurrentDocument          = setCurrentDocument;
    exports.addToWorkingSet             = addToWorkingSet;
    exports.addListToWorkingSet         = addListToWorkingSet;
    exports.removeFromWorkingSet        = removeFromWorkingSet;
    exports.getNextPrevFile             = getNextPrevFile;
    exports.swapWorkingSetIndexes       = swapWorkingSetIndexes;
    exports.sortWorkingSet              = sortWorkingSet;
    exports.beginDocumentNavigation     = beginDocumentNavigation;
    exports.finalizeDocumentNavigation  = finalizeDocumentNavigation;
    exports.closeFullEditor             = closeFullEditor;
    exports.closeAll                    = closeAll;
    exports.notifyFileDeleted           = notifyFileDeleted;
    exports.notifyPathNameChanged       = notifyPathNameChanged;

    &#x2F;&#x2F; Setup preferences
    _prefs = PreferencesManager.getPreferenceStorage(PREFERENCES_CLIENT_ID);
    $(exports).bind(&quot;currentDocumentChange workingSetAdd workingSetAddList workingSetRemove workingSetRemoveList fileNameChange workingSetReorder workingSetSort&quot;, _savePreferences);
    
    &#x2F;&#x2F; Performance measurements
    PerfUtils.createPerfMeasurement(&quot;DOCUMENT_MANAGER_GET_DOCUMENT_FOR_PATH&quot;, &quot;DocumentManager.getDocumentForPath()&quot;);

    &#x2F;&#x2F; Handle project change events
    $(ProjectManager).on(&quot;projectOpen&quot;, _projectOpen);
    $(ProjectManager).on(&quot;beforeProjectClose&quot;, _beforeProjectClose);
});</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>removeFromWorkingSet</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>file</dt>
                            <dd>(<em>!FileEntry</em>) - </dd>
                    </dl>
                    <p>Removes the given file from the working set list, if it was in the list. Does not change<br />the current editor even if it's for this file.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function removeFromWorkingSet(file) {
        &#x2F;&#x2F; If doc isn&#39;t in working set, do nothing
        var index = findInWorkingSet(file.fullPath);
        if (index === -1) {
            return;
        }
        
        &#x2F;&#x2F; Remove
        _workingSet.splice(index, 1);
        _workingSetMRUOrder.splice(findInWorkingSet(file.fullPath, _workingSetMRUOrder), 1);
        _workingSetAddedOrder.splice(findInWorkingSet(file.fullPath, _workingSetAddedOrder), 1);
        
        &#x2F;&#x2F; Dispatch event
        $(exports).triggerHandler(&quot;workingSetRemove&quot;, file);
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>setCurrentDocument</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>document</dt>
                            <dd>(<em>!Document</em>) - The Document to make current. May or may not already be in the</dd>
                    </dl>
                    <p>Changes currentDocument to the given Document, firing currentDocumentChange, which in turn<br />causes this Document's main editor UI to be shown in the editor pane, updates the selection<br />in the file tree / working set UI, etc. This call may also add the item to the working set.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function setCurrentDocument(doc) {
        
        &#x2F;&#x2F; If this doc is already current, do nothing
        if (_currentDocument === doc) {
            return;
        }

        var perfTimerName = PerfUtils.markStart(&quot;setCurrentDocument:\t&quot; + doc.file.fullPath);
        
        &#x2F;&#x2F; If file not within project tree, add it to working set right now (don&#39;t wait for it to
        &#x2F;&#x2F; become dirty)
        if (!ProjectManager.isWithinProject(doc.file.fullPath)) {
            addToWorkingSet(doc.file);
        }
        
        &#x2F;&#x2F; Adjust MRU working set ordering (except while in the middle of a Ctrl+Tab sequence)
        if (!_documentNavPending) {
            _markMostRecent(doc);
        }
        
        &#x2F;&#x2F; Make it the current document
        _currentDocument = doc;
        $(exports).triggerHandler(&quot;currentDocumentChange&quot;);
        &#x2F;&#x2F; (this event triggers EditorManager to actually switch editors in the UI)

        PerfUtils.addMeasurement(perfTimerName);
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>sortWorkingSet</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>FileEntry)}</dt>
                            <dd>(<em>!function(FileEntry, </em>) - compareFn - the function that will be used inside JavaScript's</dd>
                    </dl>
                    <p>Sorts _workingSet using the compare function</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function sortWorkingSet(compareFn) {
        _workingSet.sort(compareFn);
        $(exports).triggerHandler(&quot;workingSetSort&quot;);
    }</code></pre>
                </div>
                <div class="member public">
                    <span class="pull-right scope">
                        
                        Public API
                    </span>
                    <h4>swapWorkingSetIndexes</h4>
                    <!--<strong>Params:</strong>-->
                    <dl>
                            <dt>index</dt>
                            <dd>(<em>!number</em>) - - old file index</dd>
                            <dt>index</dt>
                            <dd>(<em>!number</em>) - - new file index</dd>
                    </dl>
                    <p>Mutually exchanges the files at the indexes passed by parameters.</p>
                    <button class="btn btn-small show-code">Show code</button>
                    <pre class="code"><code>function swapWorkingSetIndexes(index1, index2) {
        var length = _workingSet.length - 1;
        var temp;
        
        if (index1 &gt;= 0 &amp;&amp; index2 &lt;= length &amp;&amp; index1 &gt;= 0 &amp;&amp; index2 &lt;= length) {
            temp = _workingSet[index1];
            _workingSet[index1] = _workingSet[index2];
            _workingSet[index2] = temp;
            
            &#x2F;&#x2F; Dispatch event
            $(exports).triggerHandler(&quot;workingSetReorder&quot;);
        }
    }</code></pre>
                </div>
            </section>


            <section id="classes">
                <h2>Classes</h2>
                    <div class="member public">
                        <span class="pull-right scope">
                            Constructor
                        </span>
                        <h4>Document</h4>
                        <!--<strong>Params:</strong>-->
                        <dl>
                            <dt>file</dt>
                            <dd>(<em>!FileEntry</em>) - Need not lie within the project.</dd>
                            <dt>initialTimestamp</dt>
                            <dd>(<em>!Date</em>) - File's timestamp when we read it off disk.</dd>
                            <dt>rawText</dt>
                            <dd>(<em>!string</em>) - Text content of the file.</dd>
                        </dl>
                        <p>Model for the contents of a single file and its current modification state.<br />See DocumentManager documentation for important usage notes.</p>

<p>Document dispatches these events:</p>

<p>change -- When the text of the editor changes (including due to undo/redo). </p>

<pre><code>   Passes ({Document}, {ChangeList}), where ChangeList is a linked list (NOT an array)
   of change record objects. Each change record looks like:

       { from: start of change, expressed as {line: &lt;line number&gt;, ch: &lt;character offset&gt;},
         to: end of change, expressed as {line: &lt;line number&gt;, ch: &lt;chracter offset&gt;},
         text: array of lines of text to replace existing text,
         next: next change record in the linked list, or undefined if this is the last record }

   The line and ch offsets are both 0-based.

   The ch offset in "from" is inclusive, but the ch offset in "to" is exclusive. For example,
   an insertion of new content (without replacing existing content) is expressed by a range
   where from and to are the same.

   If "from" and "to" are undefined, then this is a replacement of the entire text content.

   IMPORTANT: If you listen for the "change" event, you MUST also addRef() the document 
   (and releaseRef() it whenever you stop listening). You should also listen to the "deleted"
   event.

   (FUTURE: this is a modified version of the raw CodeMirror change event format; may want to make 
   it an ordinary array)
</code></pre>

<p>deleted -- When the file for this document has been deleted. All views onto the document should<br />     be closed. The document will no longer be editable or dispatch "change" events.</p>
                        <button class="btn btn-small show-code">Show code</button>
                        <pre class="code"><code>function Document(file, initialTimestamp, rawText) {
        if (!(this instanceof Document)) {  &#x2F;&#x2F; error if constructor called without &#39;new&#39;
            throw new Error(&quot;Document constructor must be called with &#39;new&#39;&quot;);
        }
        if (_openDocuments[file.fullPath]) {
            throw new Error(&quot;Creating a document when one already exists, for: &quot; + file);
        }
        
        this.file = file;
        this.refreshText(rawText, initialTimestamp);
        
        &#x2F;&#x2F; This is a good point to clean up any old dangling Documents
        _gcDocuments();
    }</code></pre>
                    </div>

                    <section class="properties">
                        <h3>Properties<label class="checkbox">
                            <input class="toggle-public" type="checkbox"> Show Private Members
                        </label></h3>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_lineEndings</h4>
                            <dl>
                                <dt>Type</dt>
                                <dd>FileUtils.LINE_ENDINGS_CRLF, FileUtils.LINE_ENDINGS_LF</dd>
                                <dt>Private</dt>
                            </dl>
                            <p>The content's line-endings style. If a Document is created on empty text, or text with<br />inconsistent line endings, defaults to the current platform's standard endings.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype._lineEndings = null;</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_masterEditor</h4>
                            <dl>
                                <dt>Type</dt>
                                <dd>?Editor</dd>
                                <dt>Private</dt>
                            </dl>
                            <p>Editor object representing the full-size editor UI for this document. May be null if Document<br />has not yet been modified or been the currentDocument; in that case, our backing model is the<br />string _text.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype._masterEditor = null;</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_refCount</h4>
                            <dl>
                                <dt>Private</dt>
                            </dl>
                            <p>Number of clients who want this Document to stay alive. The Document is listed in<br />DocumentManager._openDocuments whenever refCount > 0.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype._refCount = 0;</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_text</h4>
                            <dl>
                                <dt>Type</dt>
                                <dd>?string</dd>
                                <dt>Private</dt>
                            </dl>
                            <p>The text contents of the file, or null if our backing model is _masterEditor.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype._text = null;</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>diskTimestamp</h4>
                            <dl>
                                <dt>Type</dt>
                                <dd>!Date</dd>
                            </dl>
                            <p>What we expect the file's timestamp to be on disk. If the timestamp differs from this, then<br />it means the file was modified by an app other than Brackets.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.diskTimestamp = null;</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>file</h4>
                            <dl>
                                <dt>Type</dt>
                                <dd>!FileEntry</dd>
                            </dl>
                            <p>The FileEntry for this document. Need not lie within the project.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.file = null;</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>isDirty</h4>
                            <dl>
                                <dt>Type</dt>
                                <dd>boolean</dd>
                            </dl>
                            <p>Whether this document has unsaved changes or not.<br />When this changes on any Document, DocumentManager dispatches a "dirtyFlagChange" event.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.isDirty = false;</code></pre>
                        </div>
                    </section>

                    <section class="methods">
                        <h3>Methods<label class="checkbox">
                            <input class="toggle-public" type="checkbox"> Show Private Members
                        </label></h3>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_ensureMasterEditor</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                            </dl>
                            <p>Guarantees that <em>masterEditor is non-null. If needed, asks EditorManager to create a new master<br />editor bound to this Document (which in turn causes Document.</em>makeEditable() to be called).<br />Should ONLY be called by Editor and Document.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype._ensureMasterEditor = function () {
        if (!this._masterEditor) {
            EditorManager._createFullEditorForDocument(this);
        }
    };</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_handleEditorChange</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                            </dl>
                            <p>Handles changes from the master backing Editor. Changes are triggered either by direct edits<br />to that Editor's UI, OR by our setText()/refreshText() methods.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype._handleEditorChange = function (event, editor, changeList) {
        &#x2F;&#x2F; On any change, mark the file dirty. In the future, we should make it so that if you
        &#x2F;&#x2F; undo back to the last saved state, we mark the file clean.
        var wasDirty = this.isDirty;
        this.isDirty = editor._codeMirror.isDirty();
        
        &#x2F;&#x2F; If file just became dirty, notify listeners, and add it to working set (if not already there)
        if (wasDirty !== this.isDirty) {
            $(exports).triggerHandler(&quot;dirtyFlagChange&quot;, [this]);
            addToWorkingSet(this.file);
        }
        
        &#x2F;&#x2F; Notify that Document&#39;s text has changed
        &#x2F;&#x2F; TODO: This needs to be kept in sync with SpecRunnerUtils.createMockDocument(). In the
        &#x2F;&#x2F; future, we should fix things so that we either don&#39;t need mock documents or that this
        &#x2F;&#x2F; is factored so it will just run in both.
        $(this).triggerHandler(&quot;change&quot;, [this, changeList]);
    };</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_makeEditable</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                                <dt>masterEditor</dt>
                                <dd>(<em>!Editor</em>) - </dd>
                            </dl>
                            <p>Attach a backing Editor to the Document, enabling setText() to be called. Assumes Editor has<br />already been initialized with the value of getText(). ONLY Editor should call this (and only<br />when EditorManager has told it to act as the master editor).</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype._makeEditable = function (masterEditor) {
        if (this._masterEditor) {
            console.error(&quot;Document is already editable&quot;);
        } else {
            this._text = null;
            this._masterEditor = masterEditor;
            $(masterEditor).on(&quot;change&quot;, this._handleEditorChange.bind(this));
        }
    };</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_makeNonEditable</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                            </dl>
                            <p>Detach the backing Editor from the Document, disallowing setText(). The text content is<br />stored back onto _text so other Document clients continue to have read-only access. ONLY<br />Editor.destroy() should call this.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype._makeNonEditable = function () {
        if (!this._masterEditor) {
            console.error(&quot;Document is already non-editable&quot;);
        } else {
            &#x2F;&#x2F; _text represents the raw text, so fetch without normalized line endings
            this._text = this.getText(true);
            this._masterEditor = null;
        }
    };</code></pre>
                        </div>
                        <div class="member private">
                            <span class="pull-right scope">
                                Private
                                
                            </span>
                            <h4>_markClean</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                            </dl>
                            <p></p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype._markClean = function () {
        this.isDirty = false;
        if (this._masterEditor) {
            this._masterEditor._codeMirror.markClean();
        }
        $(exports).triggerHandler(&quot;dirtyFlagChange&quot;, this);
    };</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>addRef</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                            </dl>
                            <p>Add a ref to keep this Document alive</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.addRef = function () {
        &#x2F;&#x2F;console.log(&quot;+++REF+++ &quot;+this);
        
        if (this._refCount === 0) {
            &#x2F;&#x2F;console.log(&quot;+++ adding to open list&quot;);
            if (_openDocuments[this.file.fullPath]) {
                console.error(&quot;Document for this path already in _openDocuments!&quot;);
                return;
            }

            _openDocuments[this.file.fullPath] = this;
            $(exports).triggerHandler(&quot;afterDocumentCreate&quot;, this);
        }
        this._refCount++;
    };</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>batchOperation</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                                <dt>doOperation</dt>
                                <dd>(<em>function()</em>) - </dd>
                            </dl>
                            <p>Batches a series of related Document changes. Repeated calls to replaceRange() should be wrapped in a<br />batch for efficiency. Begins the batch, calls doOperation(), ends the batch, and then returns.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.batchOperation = function (doOperation) {
        this._ensureMasterEditor();
        
        var self = this;
        this._masterEditor._codeMirror.compoundChange(function () {
            self._masterEditor._codeMirror.operation(doOperation);
        });
    };</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>getLine</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                                <dt>Zero-based</dt>
                                <dd>(<em>number</em>) - line number</dd>
                                <dt>Returns</dt>
                                <dd>(<em>!string</em>) - </dd>
                            </dl>
                            <p>Returns the text of the given line (excluding any line ending characters)</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.getLine = function (lineNum) {
        this._ensureMasterEditor();
        return this._masterEditor._codeMirror.getLine(lineNum);
    };</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>getRange</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                                <dt>ch:number}}</dt>
                                <dd>(<em>!line:number, </em>) - start Start of range, inclusive</dd>
                                <dt>ch:number}}</dt>
                                <dd>(<em>!line:number, </em>) - end End of range, exclusive</dd>
                                <dt>Returns</dt>
                                <dd>(<em>!string</em>) - </dd>
                            </dl>
                            <p>Returns the characters in the given range. Line endings are normalized to '\n'.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.getRange = function (start, end) {
        this._ensureMasterEditor();
        return this._masterEditor._codeMirror.getRange(start, end);
    };</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>getText</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                                <dt>useOriginalLineEndings</dt>
                                <dd>(<em>boolean=</em>) - If true, line endings in the result depend on the</dd>
                                <dt>Returns</dt>
                                <dd>(<em>string</em>) - </dd>
                            </dl>
                            <p>Returns the document's current contents; may not be saved to disk yet. Whenever this<br />value changes, the Document dispatches a "change" event.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.getText = function (useOriginalLineEndings) {
        if (this._masterEditor) {
            &#x2F;&#x2F; CodeMirror.getValue() always returns text with LF line endings; fix up to match line
            &#x2F;&#x2F; endings preferred by the document, if necessary
            var codeMirrorText = this._masterEditor._codeMirror.getValue();
            if (useOriginalLineEndings) {
                if (this._lineEndings === FileUtils.LINE_ENDINGS_CRLF) {
                    return codeMirrorText.replace(&#x2F;\n&#x2F;g, &quot;\r\n&quot;);
                }
            }
            return codeMirrorText;
            
        } else {
            &#x2F;&#x2F; Optimized path that doesn&#39;t require creating master editor
            if (useOriginalLineEndings) {
                return this._text;
            } else {
                return this._text.replace(&#x2F;\r\n&#x2F;g, &quot;\n&quot;);
            }
        }
    };</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>notifySaved</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                            </dl>
                            <p>Called when the document is saved (which currently happens in DocumentCommandHandlers). Marks the<br />document not dirty and notifies listeners of the save.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.notifySaved = function () {
        if (!this._masterEditor) {
            console.log(&quot;### Warning: saving a Document that is not modifiable!&quot;);
        }
        
        this._markClean();
        $(exports).triggerHandler(&quot;documentSaved&quot;, this);
        
        &#x2F;&#x2F; TODO: (issue #295) fetching timestamp async creates race conditions (albeit unlikely ones)
        var thisDoc = this;
        this.file.getMetadata(
            function (metadata) {
                thisDoc.diskTimestamp = metadata.modificationTime;
            },
            function (error) {
                console.log(&quot;Error updating timestamp after saving file: &quot; + thisDoc.file.fullPath);
            }
        );
    };</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>refreshText</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                                <dt>text</dt>
                                <dd>(<em>!string</em>) - The text to replace the contents of the document with.</dd>
                                <dt>newTimestamp</dt>
                                <dd>(<em>!Date</em>) - Timestamp of file at the time we read its new contents from disk.</dd>
                            </dl>
                            <p>Sets the contents of the document. Treated as reloading the document from disk: the document<br />will be marked clean with a new timestamp, the undo/redo history is cleared, and we re-check<br />the text's line-ending style. CAN be called even if there is no backing editor.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.refreshText = function (text, newTimestamp) {
        var perfTimerName = PerfUtils.markStart(&quot;refreshText:\t&quot; + (!this.file || this.file.fullPath));

        if (this._masterEditor) {
            this._masterEditor._resetText(text);
            &#x2F;&#x2F; _handleEditorChange() triggers &quot;change&quot; event for us
        } else {
            this._text = text;
            &#x2F;&#x2F; We fake a change record here that looks like CodeMirror&#39;s text change records, but
            &#x2F;&#x2F; omits &quot;from&quot; and &quot;to&quot;, by which we mean the entire text has changed.
            &#x2F;&#x2F; TODO: Dumb to split it here just to join it again in the change handler, but this is
            &#x2F;&#x2F; the CodeMirror change format. Should we document our change format to allow this to
            &#x2F;&#x2F; either be an array of lines or a single string?
            $(this).triggerHandler(&quot;change&quot;, [this, {text: text.split(&#x2F;\r?\n&#x2F;)}]);
        }
        this._markClean();
        this.diskTimestamp = newTimestamp;
        
        &#x2F;&#x2F; Sniff line-ending style
        this._lineEndings = FileUtils.sniffLineEndings(text);
        if (!this._lineEndings) {
            this._lineEndings = FileUtils.getPlatformLineEndings();
        }

        PerfUtils.addMeasurement(perfTimerName);
    };</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>releaseRef</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                            </dl>
                            <p>Remove a ref that was keeping this Document alive</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.releaseRef = function () {
        &#x2F;&#x2F;console.log(&quot;---REF--- &quot;+this);

        this._refCount--;
        if (this._refCount &lt; 0) {
            console.error(&quot;Document ref count has fallen below zero!&quot;);
            return;
        }
        if (this._refCount === 0) {
            &#x2F;&#x2F;console.log(&quot;--- removing from open list&quot;);
            if (!_openDocuments[this.file.fullPath]) {
                console.error(&quot;Document with references was not in _openDocuments!&quot;);
                return;
            }

            $(exports).triggerHandler(&quot;beforeDocumentDelete&quot;, this);
            delete _openDocuments[this.file.fullPath];
        }
    };</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>replaceRange</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                                <dt>text</dt>
                                <dd>(<em>!string</em>) - Text to insert or replace the range with</dd>
                                <dt>ch:number}}</dt>
                                <dd>(<em>!line:number, </em>) - start Start of range, inclusive (if 'to' specified) or insertion point (if not)</dd>
                                <dt>ch:number}}</dt>
                                <dd>(<em>?line:number, </em>) - end End of range, exclusive; optional</dd>
                            </dl>
                            <p>Adds, replaces, or removes text. If a range is given, the text at that range is replaced with the<br />given new text; if text == "", then the entire range is effectively deleted. If 'end' is omitted,<br />then the new text is inserted at that point and all existing text is preserved. Line endings will<br />be rewritten to match the document's current line-ending style.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.replaceRange = function (text, start, end) {
        this._ensureMasterEditor();
        this._masterEditor._codeMirror.replaceRange(text, start, end);
        &#x2F;&#x2F; _handleEditorChange() triggers &quot;change&quot; event
    };</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>setText</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                                <dt>text</dt>
                                <dd>(<em>!string</em>) - The text to replace the contents of the document with.</dd>
                            </dl>
                            <p>Sets the contents of the document. Treated as an edit. Line endings will be rewritten to<br />match the document's current line-ending style.</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.setText = function (text) {
        this._ensureMasterEditor();
        this._masterEditor._codeMirror.setValue(text);
        &#x2F;&#x2F; _handleEditorChange() triggers &quot;change&quot; event
    };</code></pre>
                        </div>
                        <div class="member">
                            <span class="pull-right scope">
                                
                                
                            </span>
                            <h4>toString</h4>
                            <!--<strong>Params:</strong>-->
                            <dl>
                            </dl>
                            <p>(pretty toString(), to aid debugging)</p>
                            <button class="btn btn-small show-code">Show code</button>
                            <pre class="code"><code>Document.prototype.toString = function () {
        var dirtyInfo = (this.isDirty ? &quot; (dirty!)&quot; : &quot; (clean)&quot;);
        var editorInfo = (this._masterEditor ? &quot; (Editable)&quot; : &quot; (Non-editable)&quot;);
        var refInfo = &quot; refs:&quot; + this._refCount;
        return &quot;[Document &quot; + this.file.fullPath + dirtyInfo + editorInfo + refInfo + &quot;]&quot;;
    };</code></pre>
                        </div>
                    </section>
            </section>
        </div>
    </div>
</div>
</body>
</html>